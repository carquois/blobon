{% extends "base.html" %}
{% load i18n thumbnail punn_tags humanize %}
{% block open-graphs %}
    <!-- Le open graphs tags -->
    <meta property="og:title" content="{{ punn.title }}" />
    <meta property="og:url" content="{{ url }}" />
    <meta property="og:image" content="http://checkdonc.ca{{ MEDIA_URL }}{{ punn.pic }}" />
    <meta property="og:site_name" content="{{ punn.author.first_name }} {{ punn.author.last_name }}" />
    <!-- Le twitter cards -->
    <meta name="twitter:card" content="photo">
    <meta name="twitter:url" content="{{ url }}">
    <meta name="twitter:title" content="{{ punn.title }}">
    <meta name="twitter:image" content="http://checkdonc.ca{{ MEDIA_URL }}{{ punn.pic }}">
    <!-- Le canonical url -->
    <link rel="canonical" href="{{ url }}" />
{% endblock %}
{% block title %} {{ punn.title }} {% endblock %}
    {% block additional-css %}
    {% endblock %}
{% block content %} 
<div class="panel">
  <div class="panel-heading">
    <h3 class="panel-title">{{ punn.title }}</h3>
  </div>
<div class="panel">
  {% if punn.youtube_id %}
  <iframe src="http://www.youtube.com/embed/{{ punn.youtube_id }}" frameborder="0" allowfullscreen></iframe>
  {% else %}
  {% if punn.pic %}
  <a href="{{ next_punn.get_absolute_url }}">
    <img style="width: 100%;" src="{{ MEDIA_URL }}{{ punn.pic }}" />
  </a>
  </div>
  {% endif %}
  {% endif %}
  {% if content %}
  <div class="panel">
    {{ content|safe }}
  </div>
  {% endif %}
<div class="panel">

<div class="media">
  <a class="pull-left" href="{% url punns.views.profile_page punn.author.username %}">
{% if punn.author.userprofile.avatar %}
                  {% thumbnail punn.author.userprofile.avatar "64x64" crop="center" as im %}
                  <img src="{{ im.url }}" alt="{{ punn.author.first_name }} {{ punn.author.last_name }}" class="img-rounded"/>
                  {% endthumbnail %}
                  {% endif %}    
  </a>
  <div class="media-body">
    <h4 class="media-heading">{{ punn.author.first_name }} {{ punn.author.last_name }} <small>@{{ punn.author.username }}</small></h4>
<p class="text-muted">{% trans "Publié" %} {{ punn.pub_date|naturaltime }}</p>
  </div>
</div>
</div>
<div class="panel">

<div class="btn-group">
<a rel="tooltip" title="{% trans "J'aime" %}" class="btn btn-default {% if vote == "U" %} btn-primary{% endif %}" href="

{% if request.user.is_authenticated %}
                       {% url votes.views.up punn.id %}
                     {% else %}
                       {% url django.contrib.auth.views.login %}?next={{request.path}}
                     {% endif %}


                             ">&#43;</a>
        <a class="btn btn-default" disabled="disabled">{{ karma }}</a>
        <a rel="tooltip" title="{% trans "Je n'aime pas" %}" class="btn btn-default {% if vote == "D" %}btn-primary{% endif %}" href="

{% if request.user.is_authenticated %}
                       {% url votes.views.down punn.id %}
                     {% else %}
                       {% url django.contrib.auth.views.login %}?next={{request.path}}
                     {% endif %}
                             ">&#45;</a>



</div>
  <div class="modal fade" id="delete">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title">{% trans "Effacer cette page?" %}</h4>
        </div>
        <div class="modal-body">
          <p>{% trans "Êtes-vous certain de vouloir faire ça? Vous ne pourrez pas revenir en arrière par la suite." %}</p>
        </div>
        <div class="modal-footer">
<button class="btn" data-dismiss="modal" aria-hidden="true">{% trans "Non non!" %}</button>
                    <a href="{% url punns.views.delete punn.id %}" class="btn btn-danger">{% trans "Oui, je veux l'effacer" %}</a>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->



<div class="btn-toolbar pull-right">
{% if punn.source %}
<div class="btn-group">
  <a href="{{ punn.source }}" target="_blank" rel="tooltip" title="{% trans "Source" %}" class="btn btn-default"><span class="glyphicon glyphicon-globe"></span></a>
</div>
{% endif %}
<div class="btn-group">
  <a rel="tooltip" title="{% trans "Partager sur Facebook" %}" class="btn btn-default" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href), 
      'facebook-share-dialog', 
      'width=626,height=436'); 
    return false;"><img src="{{ STATIC_URL }}img/facebook.png" style="width:14px;" /></a>
  <a rel="tooltip" title="{% trans "Partager sur Twitter" %}" class="btn btn-default"><img src="{{ STATIC_URL }}img/twitter.png" style="width:14px;" /></a>
</div>
<div class="btn-group">
{% if request.user.is_authenticated and punn.author == request.user %}
  <a rel="tooltip" title="{% trans "Effacer" %}" data-toggle="modal" href="#delete" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                      {% endif %}
</div>
</div>

</div>

                {% if comment_list %}

 
          <h3>{% trans "Meilleur commentaire" %}</h3>

{% for comment in comment_list|dictsortreversed:"karma" %}

                {% if forloop.counter == 2 %}
                <h3>{% trans "Tous les commentaires" %}</h3>
                {% endif %}
<div class="panel">
<div class="media">

<div class="pull-left btn-group-vertical">
        <a class="btn btn-default {% if comment.vote == "U" %}btn-primary{% endif %}" href="
                             {% if request.user.is_authenticated %}{% url votes.views.commentup comment.id %}
                             {% else %}{% url accounts.views.signup %}
                             {% endif %}
                             ">&#43;</a>
        <a class="btn btn-default" disabled="disabled">{{ comment.karma }}</a>
        <a class="btn btn-default {% if comment.vote == "D" %}btn-primary{% endif %}" href="
                             {% if request.user.is_authenticated %}{% url votes.views.commentdown comment.id %}
                             {% else %}{% url accounts.views.signup %}
                             {% endif %}
                             ">&#45;</a>
      </div>

<a href="
                             {% if request.user.is_authenticated %}{% url votes.views.commentup comment.id %}
                             {% else %}{% url accounts.views.signup %}
                             {% endif %}
                             "><div class="comment-vote comment-vote-up {% if comment.vote == "U" %}comment-vote-up-on{% endif %}"></div></a>


  <a class="pull-left" href="{% url punns.views.profile_page comment.author.username %}">
                  {% if comment.author.userprofile.avatar %}
                  {% thumbnail comment.author.userprofile.avatar "64x64" crop="center" as im %}
                  <img src="{{ im.url }}" alt="{{ comment.author.first_name }} {{ comment.author.last_name }}" class="img-rounded"/>
                  {% endthumbnail %}
                  {% endif %}
  </a>
  <div class="media-body">
    <h4 class="media-heading">{{ comment.author.first_name }} {{ comment.author.last_name }}</h4>
    {{ comment.content|safe }}
  </div>


</div>
</div>

{% endfor %}
{% endif %}













</div>




{% endblock %}
