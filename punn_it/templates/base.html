{% load thumbnail i18n compress calculate_age %}
{% load url from future %}
<!doctype>
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<html lang="en">
  <head>
    <script src="{{ STATIC_URL }}js/jquery.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{% block description %}{{ site_description }}{% endblock %}">
    <meta name="author" content="">
    <title>{% block title %}Knobshare{% endblock %}</title>
    {% block open-graphs %}
    <!-- Le open graphs tags -->
    <meta property="og:title" content="{{ site.name }}" />
    <meta property="og:url" content="http://{{ site.domain }}" />
    <meta property="og:image" content="http://{{ site.domain }}{{ STATIC_URL }}img/avatar.png" />
    <!-- Le twitter cards -->
    <meta name="twitter:card" content="photo">
    <meta name="twitter:url" content="http://{{ site.domain }}">
    <meta name="twitter:title" content="{{ site.name }}">
    <meta name="twitter:image" content="http://{{ site.domain }}{{ STATIC_URL }}img/avatar.png">
    <!-- Le canonical url -->
    <link rel="canonical" href="{{ site.name }}" />
    {% endblock %}

    {% block additional_js %}
    {% endblock %}

    <!-- Le styles -->
    {% block css %}
    <link rel="stylesheet" href="{{ STATIC_URL }}css/bootstrap.min.css">
    <link href="{{ STATIC_URL }}css/bootstrap-glyphicons.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .thumb-link {
        text-align: center;
      }
      .medium-rectangle {
      }
      .skyscrapper {
        margin-top: 20px;
      }
      #thumbs {
        display:block;
        margin:auto;
      }
      .centered {
        display:block;
        margin:auto;
      }
      #paginator {
        text-align: center;
      } 
    </style>
    <style>
    {% block additional-css %}
    {% endblock %}
    </style>
    {% compress css %}
    {% endcompress %}
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    {% endblock %}

    </script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="{{ STATIC_URL }}/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="{{ STATIC_URL }}/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="{{ STATIC_URL }}/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="{{ STATIC_URL }}/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="{{ STATIC_URL }}/ico/apple-touch-icon-57-precomposed.png">
    <link rel="shortcut icon" href="{{ STATIC_URL }}/ico/favicon.png">
        <!-- Le analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-10970225-13']);
      _gaq.push(['_setCustomVar',
            1, 
	    'author_id',
            '{{ user.id }}', 
            3
        ]);
      _gaq.push(['_setCustomVar',
            2, 
	    'author_username',
            '{{ user.username }}', 
            3
        ]);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    {% if request.user.is_authenticated %}
        _gaq.push(['_setCustomVar', 3, 'uid', '{{request.user.pk}}', 1]);
        _gaq.push(['_setCustomVar', 4, 'gender', '{{request.user.get_profile.gender}}', 1]);
        {% if request.user.get_profile.birthdate %}
        _gaq.push(['_setCustomVar', 5, 'age', '{{request.user.get_profile.birthdate|age}}', 1]);
        {% endif %}
    {% endif %}
      
    </script>
    <script type='text/javascript'>
      var googletag = googletag || {};
      googletag.cmd = googletag.cmd || [];
      (function() {
        var gads = document.createElement('script');
        gads.async = true;
        gads.type = 'text/javascript';
        var useSSL = 'https:' == document.location.protocol;
        gads.src = (useSSL ? 'https:' : 'http:') + 
        '//www.googletagservices.com/tag/js/gpt.js';
        var node = document.getElementsByTagName('script')[0];
        node.parentNode.insertBefore(gads, node);
      })();
    </script>
    <script type='text/javascript'>
      googletag.cmd.push(function() {
        googletag.defineSlot('/17303639/300x250TopRight', [[300, 250], [300, 600]], 'div-gpt-ad-1360772351679-0').addService(googletag.pubads());
        googletag.defineSlot('/17303639/MobileLeaderboardBelowTheContent', [320, 50], 'div-gpt-ad-1360772351679-1').addService(googletag.pubads());
        googletag.defineSlot('/17303639/Leaderboard', [728, 90], 'div-gpt-ad-1363051510706-0').addService(googletag.pubads());
        googletag.defineSlot('/17303639/SkyScrapper', [160, 600], 'div-gpt-ad-1363052072029-0').addService(googletag.pubads());
	googletag.pubads().enableSingleRequest();
        googletag.enableServices();
      });
    </script>
    <!-- To initialize the tooltips -->
    <script type="text/javascript">
      $(function () {
        $("[rel='tooltip']").tooltip();
      });
    </script>
  </head>
  <body>

{% block nav %}

<nav class="navbar navbar-fixed-top" role="navigation">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="{% url 'punns.views.index' %}">{% trans "Knobshare" %}</a>
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse navbar-ex1-collapse">
            {% block hotnewtop %}
            {% endblock %}
{% if request.user.is_authenticated %}
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-cog"></span> <b class="caret"></b></a>
        <ul class="dropdown-menu">
                    <li><a href="{% url 'punns.views.profile_page' request.user.username %}">{% trans "Your profile" %}</a></li>
                    <li class="divider"></li>
                    <li><a href="{% url 'accounts.views.edit_profile' %}">{% trans "Settings" %}</a></li>
                    <li class="divider"></li>
                    <li><a href="{% url 'django.contrib.auth.views.logout' %}">{% trans "Logout" %}</a></li>
        </ul>
      </li>
    </ul>
              <a class="btn btn-primary navbar-btn navbar-right" href="{% url 'punns.views.create' %}"><span class="glyphicon glyphicon-pencil"></span></a>
            {% else %}
              <a class="btn btn-default navbar-btn navbar-right" href="{% url 'django.contrib.auth.views.login' %}?next={{request.path}}">{% trans "Login" %}</a>
            {% endif %}
  </div><!-- /.navbar-collapse -->
</nav>
            {% endblock %}
      <div class="container">

            {% block container %}

<div class="row">
  <div class="col-md-8">

  {% if messages %}
          {% for message in messages %}
            <div class="alert alert-info">
              <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
              {% if 'safe' in message.tags %}{{ message|safe }}{% else %}{{ message }}{% endif %}
            </div>
          {% endfor %}
        {% endif %}

            {% block content %}
            <div class="row">
              {% block hero-unit %}
              {% if not request.user.is_authenticated %}
              <div class="jumbotron">
                <h2>{% trans "Welcome to Knobshare." %}</h2>
                <p class="lead">{% trans "Knobshare is based on a simple yet powerful principle : sharing." %} </p>
                <p>{% trans "You create or share content and you get paid. It doesn't get any better than that. Create your account today today to start earning money." %} </p>
                <p><a href="{% url 'socialauth_begin' backend='facebook' %}" class="btn btn-primary btn-lg"><span class="glyphicon glyphicon-user"></span> {% trans "Create your account" %}</a></p>
              </div>
              {% endif %}
              {% endblock %}
            </div><!--/.row -->
            <div class="row">
            {% for punn in punns %}
            {% if forloop.counter0|divisibleby:3 %}
            </div>
            <div class="row">
            {% endif %}
              <div class="col-xs-4">
                <a href="{{ punn.get_absolute_url }}" class="thumbnail">
                  {% if punn.pic %}
	          {% thumbnail punn.pic "300x300" crop="center" as im %}
  	          <img id="thumbs" src="{{ im.url }}" alt="{{ punn.title }}"/>
	          {% endthumbnail %}
	          {% else %}
	          {% thumbnail punn.author.userprofile.avatar "300x300" crop="center" as im %}
  	          <img id="thumbs" src="{{ im.url }}" alt="{{ punn.title }}"/>
	          {% endthumbnail %}
	          {% endif %}
                </a>
              </div>
            {% endfor %}
            </div>

{% if punns.has_previous or punns.has_next %}

            <div class="row">
              <ul class="pager">
                <li class="previous{% if not punns.has_previous %} disabled{% endif %}"><a href="{% if punns.has_previous %}?page={{ punns.previous_page_number }}{% endif %}">&larr; {% trans "Previous" %}</a></li>
                <li class="next{% if not punns.has_next %} disabled{% endif %}"><a href="{% if punns.has_next %}?page={{ punns.next_page_number }}{% endif %}">{% trans "Next" %} &rarr;</a></li>
              </ul>
            </div>

{% endif %}

            {% endblock %}

<div class="row visible-lg">
 <div id='div-gpt-ad-1363051510706-0' class="centered" style='width:728px; height:90px;'>
        <script type='text/javascript'>
          googletag.cmd.push(function() { googletag.display('div-gpt-ad-1363051510706-0'); });
        </script>
      </div>
            </div>

          </div><!--/.col-8 -->
  <div class="col-md-4">
            {% block sidebar %}
            <div class="panel medium-rectangle hidden-md">
              <!-- 300x250TopRight -->
              <div class="centered" id='div-gpt-ad-1360772351679-0' style='width:300px; height:250px;'>
                <script type='text/javascript'>
                  googletag.cmd.push(function() { googletag.display('div-gpt-ad-1360772351679-0'); });
                </script>
              </div>
            </div><!--/.well -->
            {% block midsidebar %}
            {% endblock  %}

            <div class="panel skyscrapper hidden-xs">
              <!-- SkyScrapper -->
              <div class="centered" id='div-gpt-ad-1363052072029-0' style='width:160px; height:600px;'>
                <script type='text/javascript'>
                  googletag.cmd.push(function() { googletag.display('div-gpt-ad-1363052072029-0'); });
                </script>
              </div>
            </div><!--/.well -->
            {% endblock  %}
  </div>
</div>



            {% block footer %}
        <hr>
        <footer>
          <p>&copy; Knobshare 2010 - {% now "Y" %}</p>
        </footer>
            {% endblock %}
            {% endblock %}

        </div><!--/row -->
      </div>
      <script src="{{ STATIC_URL }}js/bootstrap.min.js"></script>
  </body>
</html>


